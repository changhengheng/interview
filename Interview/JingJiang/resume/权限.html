<!DOCTYPE html>
<html lang="en-US" dir="ltr">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>权限 | Hello VitePress</title>
    <meta name="description" content="Just playing around.">
    <link rel="preload stylesheet" href="/interview/assets/style.460fe741.css" as="style">
    <script type="module" src="/interview/assets/app.b8e77e71.js"></script>
    <link rel="preload" href="/interview/assets/inter-roman-latin.2ed14f66.woff2" as="font" type="font/woff2" crossorigin="">
  <link rel="modulepreload" href="/interview/assets/chunks/framework.e0394e94.js">
  <link rel="modulepreload" href="/interview/assets/chunks/theme.106bf86e.js">
  <link rel="modulepreload" href="/interview/assets/Interview_JingJiang_resume_权限.md.0e49dd44.lean.js">
  <script id="check-dark-light">(()=>{const e=localStorage.getItem("vitepress-theme-appearance")||"",a=window.matchMedia("(prefers-color-scheme: dark)").matches;(!e||e==="auto"?a:e==="dark")&&document.documentElement.classList.add("dark")})();</script>
  </head>
  <body>
    <div id="app"><div class="Layout" data-v-99cf8a88><!--[--><!--]--><!--[--><span tabindex="-1" data-v-ae3e3f51></span><a href="#VPContent" class="VPSkipLink visually-hidden" data-v-ae3e3f51> Skip to content </a><!--]--><!----><header class="VPNav" data-v-99cf8a88 data-v-7e5bc4a5><div class="VPNavBar" data-v-7e5bc4a5 data-v-381568bf><div class="container" data-v-381568bf><div class="title" data-v-381568bf><div class="VPNavBarTitle" data-v-381568bf data-v-305adf00><a class="title" href="/interview/" data-v-305adf00><!--[--><!--]--><!----><!--[-->Hello VitePress<!--]--><!--[--><!--]--></a></div></div><div class="content" data-v-381568bf><div class="curtain" data-v-381568bf></div><div class="content-body" data-v-381568bf><!--[--><!--]--><div class="VPNavBarSearch search" style="--vp-meta-key:&#39;Meta&#39;;" data-v-381568bf><!----></div><nav aria-labelledby="main-nav-aria-label" class="VPNavBarMenu menu" data-v-381568bf data-v-7f418b0f><span id="main-nav-aria-label" class="visually-hidden" data-v-7f418b0f>Main Navigation</span><!--[--><!--[--><a class="VPLink link VPNavBarMenuLink" href="/interview/Interview/JingJiang/" tabindex="0" data-v-7f418b0f data-v-5e623618><!--[-->前端<!--]--></a><!--]--><!--[--><a class="VPLink link VPNavBarMenuLink" href="/interview/Interview/JingJiang/resume/" tabindex="0" data-v-7f418b0f data-v-5e623618><!--[-->项目<!--]--></a><!--]--><!--]--></nav><!----><div class="VPNavBarAppearance appearance" data-v-381568bf data-v-f6a63727><button class="VPSwitch VPSwitchAppearance" type="button" role="switch" title="toggle dark mode" aria-checked="false" data-v-f6a63727 data-v-82b282f1 data-v-f3c41672><span class="check" data-v-f3c41672><span class="icon" data-v-f3c41672><!--[--><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" viewbox="0 0 24 24" class="sun" data-v-82b282f1><path d="M12,18c-3.3,0-6-2.7-6-6s2.7-6,6-6s6,2.7,6,6S15.3,18,12,18zM12,8c-2.2,0-4,1.8-4,4c0,2.2,1.8,4,4,4c2.2,0,4-1.8,4-4C16,9.8,14.2,8,12,8z"></path><path d="M12,4c-0.6,0-1-0.4-1-1V1c0-0.6,0.4-1,1-1s1,0.4,1,1v2C13,3.6,12.6,4,12,4z"></path><path d="M12,24c-0.6,0-1-0.4-1-1v-2c0-0.6,0.4-1,1-1s1,0.4,1,1v2C13,23.6,12.6,24,12,24z"></path><path d="M5.6,6.6c-0.3,0-0.5-0.1-0.7-0.3L3.5,4.9c-0.4-0.4-0.4-1,0-1.4s1-0.4,1.4,0l1.4,1.4c0.4,0.4,0.4,1,0,1.4C6.2,6.5,5.9,6.6,5.6,6.6z"></path><path d="M19.8,20.8c-0.3,0-0.5-0.1-0.7-0.3l-1.4-1.4c-0.4-0.4-0.4-1,0-1.4s1-0.4,1.4,0l1.4,1.4c0.4,0.4,0.4,1,0,1.4C20.3,20.7,20,20.8,19.8,20.8z"></path><path d="M3,13H1c-0.6,0-1-0.4-1-1s0.4-1,1-1h2c0.6,0,1,0.4,1,1S3.6,13,3,13z"></path><path d="M23,13h-2c-0.6,0-1-0.4-1-1s0.4-1,1-1h2c0.6,0,1,0.4,1,1S23.6,13,23,13z"></path><path d="M4.2,20.8c-0.3,0-0.5-0.1-0.7-0.3c-0.4-0.4-0.4-1,0-1.4l1.4-1.4c0.4-0.4,1-0.4,1.4,0s0.4,1,0,1.4l-1.4,1.4C4.7,20.7,4.5,20.8,4.2,20.8z"></path><path d="M18.4,6.6c-0.3,0-0.5-0.1-0.7-0.3c-0.4-0.4-0.4-1,0-1.4l1.4-1.4c0.4-0.4,1-0.4,1.4,0s0.4,1,0,1.4l-1.4,1.4C18.9,6.5,18.6,6.6,18.4,6.6z"></path></svg><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" viewbox="0 0 24 24" class="moon" data-v-82b282f1><path d="M12.1,22c-0.3,0-0.6,0-0.9,0c-5.5-0.5-9.5-5.4-9-10.9c0.4-4.8,4.2-8.6,9-9c0.4,0,0.8,0.2,1,0.5c0.2,0.3,0.2,0.8-0.1,1.1c-2,2.7-1.4,6.4,1.3,8.4c2.1,1.6,5,1.6,7.1,0c0.3-0.2,0.7-0.3,1.1-0.1c0.3,0.2,0.5,0.6,0.5,1c-0.2,2.7-1.5,5.1-3.6,6.8C16.6,21.2,14.4,22,12.1,22zM9.3,4.4c-2.9,1-5,3.6-5.2,6.8c-0.4,4.4,2.8,8.3,7.2,8.7c2.1,0.2,4.2-0.4,5.8-1.8c1.1-0.9,1.9-2.1,2.4-3.4c-2.5,0.9-5.3,0.5-7.5-1.1C9.2,11.4,8.1,7.7,9.3,4.4z"></path></svg><!--]--></span></span></button></div><!----><div class="VPFlyout VPNavBarExtra extra" data-v-381568bf data-v-40855f84 data-v-764effdf><button type="button" class="button" aria-haspopup="true" aria-expanded="false" aria-label="extra navigation" data-v-764effdf><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" viewbox="0 0 24 24" class="icon" data-v-764effdf><circle cx="12" cy="12" r="2"></circle><circle cx="19" cy="12" r="2"></circle><circle cx="5" cy="12" r="2"></circle></svg></button><div class="menu" data-v-764effdf><div class="VPMenu" data-v-764effdf data-v-e7ea1737><!----><!--[--><!--[--><!----><div class="group" data-v-40855f84><div class="item appearance" data-v-40855f84><p class="label" data-v-40855f84>Appearance</p><div class="appearance-action" data-v-40855f84><button class="VPSwitch VPSwitchAppearance" type="button" role="switch" title="toggle dark mode" aria-checked="false" data-v-40855f84 data-v-82b282f1 data-v-f3c41672><span class="check" data-v-f3c41672><span class="icon" data-v-f3c41672><!--[--><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" viewbox="0 0 24 24" class="sun" data-v-82b282f1><path d="M12,18c-3.3,0-6-2.7-6-6s2.7-6,6-6s6,2.7,6,6S15.3,18,12,18zM12,8c-2.2,0-4,1.8-4,4c0,2.2,1.8,4,4,4c2.2,0,4-1.8,4-4C16,9.8,14.2,8,12,8z"></path><path d="M12,4c-0.6,0-1-0.4-1-1V1c0-0.6,0.4-1,1-1s1,0.4,1,1v2C13,3.6,12.6,4,12,4z"></path><path d="M12,24c-0.6,0-1-0.4-1-1v-2c0-0.6,0.4-1,1-1s1,0.4,1,1v2C13,23.6,12.6,24,12,24z"></path><path d="M5.6,6.6c-0.3,0-0.5-0.1-0.7-0.3L3.5,4.9c-0.4-0.4-0.4-1,0-1.4s1-0.4,1.4,0l1.4,1.4c0.4,0.4,0.4,1,0,1.4C6.2,6.5,5.9,6.6,5.6,6.6z"></path><path d="M19.8,20.8c-0.3,0-0.5-0.1-0.7-0.3l-1.4-1.4c-0.4-0.4-0.4-1,0-1.4s1-0.4,1.4,0l1.4,1.4c0.4,0.4,0.4,1,0,1.4C20.3,20.7,20,20.8,19.8,20.8z"></path><path d="M3,13H1c-0.6,0-1-0.4-1-1s0.4-1,1-1h2c0.6,0,1,0.4,1,1S3.6,13,3,13z"></path><path d="M23,13h-2c-0.6,0-1-0.4-1-1s0.4-1,1-1h2c0.6,0,1,0.4,1,1S23.6,13,23,13z"></path><path d="M4.2,20.8c-0.3,0-0.5-0.1-0.7-0.3c-0.4-0.4-0.4-1,0-1.4l1.4-1.4c0.4-0.4,1-0.4,1.4,0s0.4,1,0,1.4l-1.4,1.4C4.7,20.7,4.5,20.8,4.2,20.8z"></path><path d="M18.4,6.6c-0.3,0-0.5-0.1-0.7-0.3c-0.4-0.4-0.4-1,0-1.4l1.4-1.4c0.4-0.4,1-0.4,1.4,0s0.4,1,0,1.4l-1.4,1.4C18.9,6.5,18.6,6.6,18.4,6.6z"></path></svg><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" viewbox="0 0 24 24" class="moon" data-v-82b282f1><path d="M12.1,22c-0.3,0-0.6,0-0.9,0c-5.5-0.5-9.5-5.4-9-10.9c0.4-4.8,4.2-8.6,9-9c0.4,0,0.8,0.2,1,0.5c0.2,0.3,0.2,0.8-0.1,1.1c-2,2.7-1.4,6.4,1.3,8.4c2.1,1.6,5,1.6,7.1,0c0.3-0.2,0.7-0.3,1.1-0.1c0.3,0.2,0.5,0.6,0.5,1c-0.2,2.7-1.5,5.1-3.6,6.8C16.6,21.2,14.4,22,12.1,22zM9.3,4.4c-2.9,1-5,3.6-5.2,6.8c-0.4,4.4,2.8,8.3,7.2,8.7c2.1,0.2,4.2-0.4,5.8-1.8c1.1-0.9,1.9-2.1,2.4-3.4c-2.5,0.9-5.3,0.5-7.5-1.1C9.2,11.4,8.1,7.7,9.3,4.4z"></path></svg><!--]--></span></span></button></div></div></div><!----><!--]--><!--]--></div></div></div><!--[--><!--]--><button type="button" class="VPNavBarHamburger hamburger" aria-label="mobile navigation" aria-expanded="false" aria-controls="VPNavScreen" data-v-381568bf data-v-e5dd9c1c><span class="container" data-v-e5dd9c1c><span class="top" data-v-e5dd9c1c></span><span class="middle" data-v-e5dd9c1c></span><span class="bottom" data-v-e5dd9c1c></span></span></button></div></div></div></div><!----></header><!----><!----><div class="VPContent" id="VPContent" data-v-99cf8a88 data-v-97b5189c><div class="VPDoc has-aside" data-v-97b5189c data-v-e9631fd0><!--[--><!--]--><div class="container" data-v-e9631fd0><div class="aside" data-v-e9631fd0><div class="aside-curtain" data-v-e9631fd0></div><div class="aside-container" data-v-e9631fd0><div class="aside-content" data-v-e9631fd0><div class="VPDocAside" data-v-e9631fd0 data-v-3f215769><!--[--><!--]--><!--[--><!--]--><div class="VPDocAsideOutline" data-v-3f215769 data-v-ff0f39c8><div class="content" data-v-ff0f39c8><div class="outline-marker" data-v-ff0f39c8></div><div class="outline-title" data-v-ff0f39c8>In this article</div><nav aria-labelledby="doc-outline-aria-label" data-v-ff0f39c8><span class="visually-hidden" id="doc-outline-aria-label" data-v-ff0f39c8> Table of Contents for current page </span><ul class="root" data-v-ff0f39c8 data-v-b0ff2abe><!--[--><!--]--></ul></nav></div></div><!--[--><!--]--><div class="spacer" data-v-3f215769></div><!--[--><!--]--><!----><!--[--><!--]--><!--[--><!--]--></div></div></div></div><div class="content" data-v-e9631fd0><div class="content-container" data-v-e9631fd0><!--[--><!--]--><!----><main class="main" data-v-e9631fd0><div style="position:relative;" class="vp-doc _interview_Interview_JingJiang_resume_%E6%9D%83%E9%99%90" data-v-e9631fd0><div><h1 id="权限" tabindex="-1">权限 <a class="header-anchor" href="#权限" aria-label="Permalink to &quot;权限&quot;">​</a></h1><p>权限控制：分前端控制和后端控制</p><h2 id="先说前端控制" tabindex="-1">先说前端控制： <a class="header-anchor" href="#先说前端控制" aria-label="Permalink to &quot;先说前端控制：&quot;">​</a></h2><p>菜单权限控制</p><ol><li>目的是让不同的用户登录后看到不同的菜单</li><li>菜单是遍历路由产生的，菜单不同，代表不同用户的路由不一样</li><li>路由是用户信息数据遍历产生的</li></ol><p>拆分路由（为什么）：不做权限控制的时候，所有的路由都放在一个路由数组里面，叫静态路由、常量路由，任何用户看到的路由就是一样的，想要做权限控制，就不能用一个路由去控制了，就需要拆分三大路由：</p><ul><li>静态路由：所有用户都能看到的路由</li><li>动态路由、异步路由：根据用户信息数据筛选出来的用户具有权限的路由</li><li>任意路由：404，必须放最后</li></ul><p>怎么做：</p><ul><li>登录后跳到全局前置守卫里获取用户信息（维护用户信息流程），获取到用户信息之后，从用户的权限信息数据中获取到自己的动态路由（异步路由）</li><li>通过 addRoute、addRoutes 将过滤出来的自己的异步路由动态的添加到路由器当中（做这一步只是实现了输入路径可以跳转，但组件还没办法显示，侧边栏也没办法显示）（因为路由数组还没有更新）</li><li>所以，最后还要把静态路由、用户自己的动态路由、任意路由合并到一个数组里面（实现菜单显示），让菜单展示时遍历这个数组</li></ul><p>权限数据管理</p><ul><li>有用户、角色、菜单：</li><li>多对多关系，一个用户可以有多个角色，角色可以分配给多个用户；角色有多个菜单，菜单分配给多个角色；</li><li>从属关系：角色只能设置给用户，菜单只能设置给角色；</li></ul><div class="tip custom-block"><p class="custom-block-title">TIP</p><p>后台返回的数据是角色、菜单、按钮</p></div><p>按钮权限控制：</p><p>自定义插件添加一个自定义指令 v-has，在每个按钮身上使用，值是每个按钮对应的权限信息数据，v-has 会判断这个值在不在用户返回的按钮权限信息数组里，如果在就显示，不再就不显示</p><div class="language-js"><button title="Copy Code" class="copy"></button><span class="lang">js</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#676E95;font-style:italic;">// 自定义插件</span></span>
<span class="line"><span style="color:#676E95;font-style:italic;">// 插件分为对象式插件和函数式插件</span></span>
<span class="line"><span style="color:#676E95;font-style:italic;">// 对象式插件是一个对象</span></span>
<span class="line"><span style="color:#676E95;font-style:italic;">// 函数式插件是一个函数</span></span>
<span class="line"><span style="color:#676E95;font-style:italic;">// 对象式插件内部必须有一个方法叫 install</span></span>
<span class="line"><span style="color:#676E95;font-style:italic;">// 函数式插件，不需要有固定的名称，这个函数就是当做 install 去用</span></span>
<span class="line"><span style="color:#676E95;font-style:italic;">// 不管什么插件，本质都是在调用函数</span></span>
<span class="line"><span style="color:#676E95;font-style:italic;">// v2 当中之前所写的 Vue.use(插件)，叫做声明使用插件，本质就是在调用插件的函数</span></span>
<span class="line"><span style="color:#676E95;font-style:italic;">// 对象式</span></span>
<span class="line"><span style="color:#676E95;font-style:italic;">// {</span></span>
<span class="line"><span style="color:#676E95;font-style:italic;">//   intall(){</span></span>
<span class="line"><span style="color:#676E95;font-style:italic;">//   }</span></span>
<span class="line"><span style="color:#676E95;font-style:italic;">// }</span></span>
<span class="line"></span>
<span class="line"><span style="color:#676E95;font-style:italic;">// 函数式</span></span>
<span class="line"><span style="color:#676E95;font-style:italic;">// function xxx(Vue) {</span></span>
<span class="line"><span style="color:#676E95;font-style:italic;">// }</span></span>
<span class="line"></span>
<span class="line"><span style="color:#89DDFF;font-style:italic;">export</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">function</span><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">hasBtnPermission</span><span style="color:#89DDFF;">(</span><span style="color:#A6ACCD;font-style:italic;">app</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">App</span><span style="color:#89DDFF;">)</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#89DDFF;">    </span><span style="color:#676E95;font-style:italic;">// 插件当中可以给 vue 添加任意你想添加的功能</span></span>
<span class="line"><span style="color:#89DDFF;">    </span><span style="color:#676E95;font-style:italic;">// 自定义一个指令 v-has，指令名是不带 v - 的，用的时候要带 v-</span></span>
<span class="line"><span style="color:#89DDFF;">    </span><span style="color:#676E95;font-style:italic;">// 指令名必须全小写</span></span>
<span class="line"><span style="color:#89DDFF;">    </span><span style="color:#676E95;font-style:italic;">// app.directive(&#39;has&#39;， (element， bindings) =&gt; {</span></span>
<span class="line"><span style="color:#89DDFF;">    </span><span style="color:#676E95;font-style:italic;">//   console.log(element);</span></span>
<span class="line"></span>
<span class="line"><span style="color:#89DDFF;">    </span><span style="color:#676E95;font-style:italic;">//   // 谁用了 v-has，回调就会执行，一般接收两个参数</span></span>
<span class="line"><span style="color:#89DDFF;">    </span><span style="color:#676E95;font-style:italic;">//   // element 代表使用 v-has 的真实 dom 元素</span></span>
<span class="line"><span style="color:#89DDFF;">    </span><span style="color:#676E95;font-style:italic;">//   // bindings 代表绑定的数据组成的对象，想要拿到 v-has 后面的数据，bindings.value 去拿</span></span>
<span class="line"><span style="color:#89DDFF;">    </span><span style="color:#676E95;font-style:italic;">//   if (!useUserInfoStore().userInfo.buttons.includes(bindings.value)) {</span></span>
<span class="line"><span style="color:#89DDFF;">    </span><span style="color:#676E95;font-style:italic;">//     element.parentNode.removeChild(element)</span></span>
<span class="line"><span style="color:#89DDFF;">    </span><span style="color:#676E95;font-style:italic;">//   }</span></span>
<span class="line"><span style="color:#89DDFF;">    </span><span style="color:#676E95;font-style:italic;">// })</span></span>
<span class="line"></span>
<span class="line"><span style="color:#89DDFF;">    </span><span style="color:#676E95;font-style:italic;">// 上面的写法会在 mounted 和 updated 都会执行，效率不高</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F07178;">    </span><span style="color:#A6ACCD;">app</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">directive</span><span style="color:#F07178;">(</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">has</span><span style="color:#89DDFF;">&quot;</span><span style="color:#F07178;">， </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#F07178;">        mounted</span><span style="color:#89DDFF;">(</span><span style="color:#A6ACCD;font-style:italic;">element</span><span style="color:#F07178;">， </span><span style="color:#A6ACCD;font-style:italic;">bindings</span><span style="color:#89DDFF;">)</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#F07178;">            </span><span style="color:#A6ACCD;">console</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">log</span><span style="color:#F07178;">(</span><span style="color:#A6ACCD;">element</span><span style="color:#F07178;">)</span><span style="color:#89DDFF;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#89DDFF;">            </span><span style="color:#676E95;font-style:italic;">// 谁用了 v-has，回调就会执行，一般接收两个参数</span></span>
<span class="line"><span style="color:#89DDFF;">            </span><span style="color:#676E95;font-style:italic;">// element 代表使用 v-has 的真实 dom 元素</span></span>
<span class="line"><span style="color:#89DDFF;">            </span><span style="color:#676E95;font-style:italic;">// bindings 代表绑定的数据组成的对象，想要拿到 v-has 后面的数据，bindings.value 去拿</span></span>
<span class="line"><span style="color:#F07178;">            </span><span style="color:#89DDFF;font-style:italic;">if</span><span style="color:#F07178;"> (</span><span style="color:#89DDFF;">!</span><span style="color:#82AAFF;">useUserInfoStore</span><span style="color:#F07178;">()</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">userInfo</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">buttons</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">includes</span><span style="color:#F07178;">(</span><span style="color:#A6ACCD;">bindings</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">value</span><span style="color:#F07178;">)) </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#F07178;">                </span><span style="color:#A6ACCD;">element</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">parentNode</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">removeChild</span><span style="color:#F07178;">(</span><span style="color:#A6ACCD;">element</span><span style="color:#F07178;">)</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#F07178;">            </span><span style="color:#89DDFF;">}</span></span>
<span class="line"><span style="color:#F07178;">        </span><span style="color:#89DDFF;">}</span><span style="color:#F07178;">，</span></span>
<span class="line"><span style="color:#F07178;">    </span><span style="color:#89DDFF;">}</span><span style="color:#F07178;">)</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#89DDFF;">}</span></span></code></pre></div><h2 id="后端控制" tabindex="-1">后端控制 <a class="header-anchor" href="#后端控制" aria-label="Permalink to &quot;后端控制&quot;">​</a></h2><p>前台返回的用户信息数据是字符串数组，后台控制意思是说由后台返回动态路由</p><p>后台返回的是真真正正的路由数组，后期拆分路由只需要拆成两部分即可：静态和任意，动态由后端控制；</p><p>前台处理动态路由：需要递归遍历返回的动态路由生成懒加载的前台路由</p><p>动态添加路由：通过 addRoute、addRoutes 将生成的懒加载的异步路由、拆分的静态和任意路由动态的添加到路由器当中</p><h2 id="区别" tabindex="-1">区别 <a class="header-anchor" href="#区别" aria-label="Permalink to &quot;区别&quot;">​</a></h2><p>前台控制，路由是自己写在路由器里的；后台控制，动态路由是后台返回给前端的，缺点是返回的 component 的值是路由的地址，需要自己转化成懒加载的路由组件，变成真正的前端路由，最终才添加到路由器的；</p><p>区别：</p><ol><li>前台返回的是字符串数组，后台返回的是路由数组</li><li>前台拆分三大路由，后台拆分两大路由</li></ol><p>后台控制更好一点</p><hr><h2 id="路由权限控制" tabindex="-1">路由权限控制 <a class="header-anchor" href="#路由权限控制" aria-label="Permalink to &quot;路由权限控制&quot;">​</a></h2><p>bug1：模板项目自身代码的问题</p><ul><li><p>描述: 在权限路由上刷新 / 登陆成功后跳转到权限路由， 页面是空白的，进不了 404</p></li><li><p>原因: 在请求获取用户信息 (包含路由权限) 后， 自动动态添加了权限路由；我们是无条件放行 next()；但由于这个操作发生在一次路由跳转的过程中， 这次的路由跳转是看不到新添加的路由；只有再次跳转一下（next(to)），才能看到最新添加的异步路由；</p></li><li><p>解决:</p></li></ul><div class="language-js"><button title="Copy Code" class="copy"></button><span class="lang">js</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#676E95;font-style:italic;">// next() // 放行， 没有重新跳转， 看不到最新添加的动态路由</span></span>
<span class="line"><span style="color:#676E95;font-style:italic;">// next(to.path) // 重新跳转到目标路由， 但丢失了参数 (如果有的话)</span></span>
<span class="line"><span style="color:#82AAFF;">next</span><span style="color:#A6ACCD;">(</span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#89DDFF;">...</span><span style="color:#A6ACCD;">to</span></span>
<span class="line"><span style="color:#89DDFF;">}</span><span style="color:#A6ACCD;">) </span><span style="color:#676E95;font-style:italic;">// 重新跳转到目标路由， 且参数不会丢失</span></span>
<span class="line"><span style="color:#A6ACCD;">NProgress</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">done</span><span style="color:#A6ACCD;">() </span><span style="color:#676E95;font-style:italic;">// 结束进度条</span></span></code></pre></div><p>bug2: 我们代码的问题</p><ul><li>描述: 如果先用一个 A 用户登陆， 退出后用 B 用户登陆， 结果看到与 A 用户相同部分的菜单是</li><li>原因: 我们在过滤总的异步路由数组中， 过滤掉了内部部分子路由， 另一个用户登陆看不到总的路由数组了</li><li>解决: 深拷贝然后再进行过滤 ==&gt; 不去改变总的异步路由数组</li></ul><h2 id="按钮权限控制" tabindex="-1">按钮权限控制 <a class="header-anchor" href="#按钮权限控制" aria-label="Permalink to &quot;按钮权限控制&quot;">​</a></h2><ul><li>是什么效果? 有权限的按钮才显示</li><li>需要进行权限控制的按钮都对应一个唯一的标识名称: btn. User.add</li><li>实现: <ul><li>获取用户信息时得到了所有的按钮权限名称的数组 [&#39;btn. Attr.add&#39;， &#39;btn. Attr.remove&#39;]</li><li>定义一个用于判断当前用户是否有指定按钮权限的函数 ==&gt; 将其绑定到 Vue 的原型上， 让所有组件都可以直接使用</li><li>在组件的模板中， 使用 v-if + 按钮权限判断函数来判断是否显示某个按钮</li></ul></li></ul><h2 id="总结" tabindex="-1">总结 <a class="header-anchor" href="#总结" aria-label="Permalink to &quot;总结&quot;">​</a></h2><p>路由（菜单）权限的控制</p><ul><li>全局路由导航守卫 和 动态添加路由 才能做路由菜单权限控制 <ol><li>用户登录</li><li>全局路由导航守卫当中获取用户的菜单权限数据信息（name 数组 routes）</li><li>根据用户的菜单权限数据信息，从所有的异步路由当中过滤出当前用户自己的异步路由</li><li>使用路由器的动态添加路由，将用户的异步路由和任意路由，动态添加到路由器当中</li><li>菜单是根据，当前用户的所有路由，动态生成</li></ol></li></ul></div></div></main><footer class="VPDocFooter" data-v-e9631fd0 data-v-face870a><!--[--><!--]--><!----><!----></footer><!--[--><!--]--></div></div></div><!--[--><!--]--></div></div><!----><!--[--><!--]--></div></div>
    <script>__VP_HASH_MAP__ = JSON.parse("{\"interview_index.md\":\"db9e0138\",\"frontend_服务端_nvm.md\":\"a6707bc4\",\"interview_jingjiang_新增内容_树状列表懒加载流程.md\":\"aef14cc1\",\"interview_jingjiang_自己补充的_双飞翼布局.md\":\"381fcc0c\",\"interview_jingjiang_新增内容_map、set、weakmap、weakset.md\":\"f1afcaf6\",\"interview_jingjiang_自己补充的_数组搜索方法总结.md\":\"71594196\",\"interview_jingjiang_自己补充的_圣杯布局.md\":\"f7caa050\",\"meaningfullife_自我实现_前端项目.md\":\"8f3f695e\",\"interview_jingjiang_自己补充的_等高布局.md\":\"c1b2fc66\",\"interview_jingjiang_新增内容_echars.md\":\"818300c1\",\"interview_jingjiang_vue_源码_deffing算法和key的作用.md\":\"21cfce21\",\"interview_jingjiang_自己补充的_三列布局.md\":\"972675b5\",\"meaningfullife_m_2023-7-14——刘渊.md\":\"c9767838\",\"interview_qitagaopinmianshiti_继承方式.md\":\"0591970b\",\"interview_jingjiang_gongchenghua_babel.md\":\"a98a05c1\",\"interview_jingjiang_javascript_webworker.md\":\"63c2ee32\",\"interview_jingjiang_自己补充的_移动端.md\":\"2d97bf70\",\"frontend_前端开发比较有用的包_index.md\":\"3d082a1a\",\"interview_jingjiang_自己补充的_flex布局.md\":\"de994ecd\",\"meaningfullife_自我实现_立项-收集.md\":\"17aab569\",\"index.md\":\"91b317ab\",\"interview_jingjiang_shashoujian_断点续传.md\":\"3fa15923\",\"interview_jingjiang_javascript_常见的数组方法有哪些.md\":\"674b3f65\",\"interview_jingjiang_javascript_es6新特性.md\":\"58cc567f\",\"interview_jingjiang_自己补充的_localstorage和sessionstorage.md\":\"e61103a3\",\"interview_jingjiang_javascript_promise.md\":\"a4c9a39b\",\"interview_jingjiang_miniprogram_uniapp打包apk.md\":\"605fbdd8\",\"interview_jingjiang_javascript_执行上下文.md\":\"5543b3b2\",\"interview_jingjiang_miniprogram_index.md\":\"3974ed55\",\"interview_jingjiang_miniprogram_uniapp和原生小程序的区别.md\":\"7ca72964\",\"interview_jingjiang_javascript_闭包.md\":\"9b55ccc9\",\"interview_jingjiang_miniprogram_上线后修改代码，让用户看到新效果.md\":\"31e70dd7\",\"interview_jingjiang_miniprogram_小程序分包（重点）.md\":\"8f523f06\",\"interview_jingjiang_miniprogram_小程序登录流程.md\":\"b96f0be3\",\"interview_jingjiang_miniprogram_小程序路由的区别.md\":\"c0f9708d\",\"interview_jingjiang_miniprogram_开发 uni-app 项目，使用过哪些插件库.md\":\"4d443ce6\",\"interview_jingjiang_mobileterminal_rem适配（重点）（原题）.md\":\"78eeb4a3\",\"interview_jingjiang_mobileterminal_1物理像素适配.md\":\"7a736165\",\"interview_jingjiang_other_ref和reactive的区别.md\":\"2df3b998\",\"interview_jingjiang_shashoujian_代码优化.md\":\"c6ade988\",\"interview_jingjiang_shashoujian_封装组件的思路：动态form表单.md\":\"8c0797a9\",\"interview_jingjiang_自己补充的_维护用户信息流程【登录流程】【用户信息持久化】【token校验】.md\":\"cd501adf\",\"interview_jingjiang_resume_axios二次封装.md\":\"930d4858\",\"interview_jingjiang_resume_axios二次封装_axios二次封装.md\":\"b3ca47a1\",\"interview_jingjiang_other_promise和async、await的区别.md\":\"38ccbbf6\",\"interview_jingjiang_gongchenghua_webpack优化.md\":\"7fc83e70\",\"interview_jingjiang_resume_index.md\":\"6f98aee4\",\"interview_jingjiang_resume_axios二次封装_index.md\":\"b1e3b5c1\",\"interview_jingjiang_shashoujian_大文件上传.md\":\"72770675\",\"interview_jingjiang_resume_axios二次封装_window.loaction.path.md\":\"a671e6c6\",\"interview_jingjiang_resume_作用域样式与深度样式选择器.md\":\"1f014d2f\",\"interview_jingjiang_other_get请求和post请求的区别.md\":\"bca60a39\",\"interview_jingjiang_miniprogram_小程序组件的使用.md\":\"17672ef4\",\"interview_jingjiang_shashoujian_上传进度条功能.md\":\"e0076291\",\"interview_jingjiang_resume_axios二次封装_axios取消请求.md\":\"b621a655\",\"interview_jingjiang_index.md\":\"ecae9265\",\"interview_jingjiang_resume_大文件上传.md\":\"d75fbfb2\",\"interview_jingjiang_miniprogram_小程序通信方案.md\":\"23af42c6\",\"interview_jingjiang_mobileterminal_为什么要做适配.md\":\"b365b1e2\",\"interview_jingjiang_miniprogram_小程序支付流程.md\":\"d39471ac\",\"interview_jingjiang_mobileterminal_viewport适配（重点）.md\":\"828f09eb\",\"interview_jingjiang_resume_echarts大屏适配.md\":\"738c8f57\",\"interview_jingjiang_miniprogram_小程序生命周期.md\":\"dee17bde\",\"interview_jingjiang_resume_拖拽排序.md\":\"ebd3991d\",\"interview_jingjiang_resume_项目优化.md\":\"152a2860\",\"interview_jingjiang_resume_导出pdf.md\":\"e98fcb38\",\"interview_jingjiang_新增内容_echarts.md\":\"cac68469\",\"meaningfullife_自我实现_包容.md\":\"9f81858c\",\"meaningfullife_自我实现_听课听不进去，自学能学进去.md\":\"bce3ea44\",\"interview_jingjiang_新增内容_index.md\":\"9dd06dae\",\"interview_jingjiang_新增内容_echarts常用配置（源文档）.md\":\"6cc8d9c6\",\"meaningfullife_自我实现_自己的想法.md\":\"d19ce4e0\",\"meaningfullife_自我实现_webpack也是一个包.md\":\"9db14b9e\",\"interview_jingjiang_resume_权限.md\":\"0e49dd44\",\"interview_jingjiang_新增内容_可视化大屏.md\":\"0f8285c1\",\"meaningfullife_自我实现_分裂的本原.md\":\"74e010a0\",\"meaningfullife_自我实现_及时复习.md\":\"8bed88c0\",\"meaningfullife_自我实现_怎么看文档.md\":\"64b95b64\",\"meaningfullife_自我实现_自律.md\":\"df830508\",\"interview_jingjiang_新增内容_添加功能点.md\":\"43fc877f\",\"interview_jingjiang_新增内容_新增的课堂笔记.md\":\"b68b7d92\",\"meaningfullife_自我实现_觉得自己有病，不要跑偏了.md\":\"6511b863\",\"interview_jingjiang_新增内容_项目相关.md\":\"289a7495\",\"interview_jingjiang_自己补充的_css预处理器.md\":\"a9f280b3\",\"interview_jingjiang_自己补充的_dom和bom.md\":\"5a31a283\",\"interview_jingjiang_typescript_ts和js的区别.md\":\"80ebaef8\",\"interview_jingjiang_新增内容_解构赋值.md\":\"524fb4f6\",\"flag_index.md\":\"e794e8dd\",\"interview_jingjiang_自己补充的_js数组方法总结.md\":\"6ecdac3b\",\"interview_jingjiang_shashoujian_项目中遇到了什么比较难解决的问题？怎么解决的？（项目难点）.md\":\"3e911313\",\"interview_jingjiang_新增内容_配置prettier、husky、commitlint实现代码和git规范化.md\":\"e1e980b5\",\"interview_jingjiang_自己补充的_js字符串方法总结.md\":\"a3e514ec\",\"interview_jingjiang_新增内容_gis地图.md\":\"f0360de4\",\"interview_jingjiang_gongchenghua_vite和webpack的区别.md\":\"6f908813\",\"meaningfullife_2023年7月17日.md\":\"163fbe0e\",\"interview_面试课_index.md\":\"0c6f70f9\",\"interview_面试课_下午.md\":\"7cf4a8a4\",\"interview_面试课_简历.md\":\"d7f4ee7e\",\"meaningfullife_2023年7月16日.md\":\"525891fa\",\"frontend_组件库_element-ui-plus_栅格系统.md\":\"0c9a14f2\",\"interview_xiangmuzongjie_支付流程.md\":\"7ddd1174\",\"interview_jingjiang_gongchenghua_eslint.md\":\"1de9b83f\",\"interview_jingjiang_javascript_作用域.md\":\"200d4b45\",\"interview_jingjiang_fuwuduan_谈谈ajax和xhr.md\":\"f543d105\",\"interview_jingjiang_javascript_作用域链.md\":\"3642d992\",\"interview_jingjiang_javascript_变量对象.md\":\"d528b0ad\",\"interview_jingjiang_javascript_如何判断js数据类型.md\":\"a280bc18\",\"meaningfullife_m_sj.md\":\"df5a4bcc\",\"interview_jingjiang_fuwuduan_websocket.md\":\"9bd5acca\",\"interview_jingjiang_javascript_模块化.md\":\"c1efc1f0\",\"frontend_html和css_width和height的问题.md\":\"f9fd7962\",\"frontend_html和css_background-image.md\":\"66763d0d\",\"interview_jingjiang_vue_vuerouter_路由导航守卫.md\":\"37188e39\",\"interview_jingjiang_新增内容_虚拟列表.md\":\"6ea4d47c\",\"meaningfullife_自我实现_表达.md\":\"1e7215c3\",\"interview_jingjiang_html和css_index.md\":\"cb7fd03e\",\"meaningfullife_意义感.md\":\"58e73168\",\"meaningfullife_m_rq.md\":\"07ed8b7d\",\"interview_qitagaopinmianshiti_localstorage、sessionstorage和cookie区别.md\":\"38aca975\",\"interview_jingjiang_typescript_interface和type的区别.md\":\"de243c11\",\"interview_jingjiang_vue_基础_为什么不推荐v-for与v-if一起使用.md\":\"117498b7\",\"interview_jingjiang_javascript_this.md\":\"ba69a5d7\",\"interview_jingjiang_fuwuduan_强制缓存和协商缓存.md\":\"62dd8335\",\"interview_jingjiang_自己补充的_react.md\":\"7b1b025b\",\"meaningfullife_2023-7-31.md\":\"5c309f62\",\"interview_jingjiang_vue_基础_组件间通信.md\":\"bb7c1b7e\",\"interview_jingjiang_vue_项目上线流程.md\":\"11fd259a\",\"meaningfullife_2023年7月20日.md\":\"d78194a5\",\"interview_qitagaopinmianshiti_index.md\":\"6cb23303\",\"interview_jingjiang_resume_富文本编辑器.md\":\"89fa4a46\",\"interview_jingjiang_vue_源码_vue3响应式数据原理.md\":\"e6139c0f\",\"interview_jingjiang_vue_源码_vue完整执行流程、数据代理、数据劫持.md\":\"d8b0889d\",\"interview_jingjiang_vue_源码_v-model双向数据绑定原理.md\":\"a8c71c36\",\"interview_jingjiang_miniprogram_小程序上线流程.md\":\"10d06acb\",\"meaningfullife_自我实现_借鉴vue源码的思路.md\":\"f4a034e0\",\"interview_jingjiang_自己补充的_遍历方法的效率.md\":\"3bc2a296\",\"interview_jingjiang_javascript_数据类型.md\":\"fa7a5eca\",\"interview_jingjiang_gongchenghua_webpack.md\":\"474c4d04\",\"interview_jingjiang_vue_源码_数据代理和数据劫持.md\":\"54da703a\",\"interview_jingjiang_vue_源码_nexttick源码.md\":\"bb118c00\",\"interview_qitagaopinmianshiti_内存泄漏和内存溢出.md\":\"d92ed856\",\"meaningfullife_基础学完就剩下套路了.md\":\"97062dcd\",\"interview_qitagaopinmianshiti_undefined和null的区别.md\":\"60b45e75\",\"meaningfullife_怎么总结.md\":\"e517aa97\",\"interview_jingjiang_typescript_泛型.md\":\"a7508bdf\",\"interview_qitagaopinmianshiti_项目优化.md\":\"c6f023a9\",\"interview_jingjiang_vue_源码_keep-alive源码.md\":\"4733b6e7\",\"interview_jingjiang_vue_基础_scope.md\":\"96608112\",\"meaningfullife_2023年7月19日.md\":\"3a899538\",\"interview_jingjiang_vue_基础_v-if和v-show的区别.md\":\"e87c8319\",\"meaningfullife_2023年7月18日.md\":\"bb0beab9\",\"interview_jingjiang_vue_基础_computed与watch的区别.md\":\"8e55847b\",\"meaningfullife_关键.md\":\"fb9a9983\",\"interview_jingjiang_vue_基础_computed和methods的区别.md\":\"8f5c889d\",\"interview_jingjiang_vue_vuerouter_路由模式：history和hash的区别.md\":\"f044cd32\"}")
__VP_SITE_DATA__ = JSON.parse("{\"lang\":\"en-US\",\"dir\":\"ltr\",\"title\":\"Hello VitePress\",\"description\":\"Just playing around.\",\"base\":\"/interview/\",\"head\":[],\"appearance\":true,\"themeConfig\":{\"outline\":{\"level\":[2,6],\"label\":\"In this article\"},\"nav\":[{\"text\":\"前端\",\"link\":\"/Interview/JingJiang/\"},{\"text\":\"项目\",\"link\":\"/Interview/JingJiang/resume/\"}],\"sidebar\":{\"/Interview/JingJiang/day01、Html和CSS/\":[{\"text\":\"Html和CSS\",\"collapsible\":\"true\",\"collapsed\":\"true\",\"link\":\"/Interview/JingJiang/day01、Html和CSS/index\"}],\"/Interview/JingJiang/day02、JavaScript/\":{\"text\":\"JavaScript\",\"collapsible\":\"true\",\"collapsed\":\"true\",\"items\":[{\"text\":\"JavaScript\",\"link\":\"/Interview/JingJiang/day02、JavaScript/index\"}]}},\"lastUpdated\":\"last update\"},\"locales\":{},\"scrollOffset\":90,\"cleanUrls\":false}")</script>
    
  </body>
</html>